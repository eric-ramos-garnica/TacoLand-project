{% extends 'base.html' %}
{% block title %}Edit page{% endblock %}
{% block body %}
<h1>Edit account</h1>
<hr>

<form action="/editpage" id="vendor-form" method="POST" enctype="multipart/form-data">
    <div id="containter-form">
        <label for="vendorName">Business Name</label><br>
        <input type="text" name="vendorName" id="vendorName"><br>

        <label for="address">Address</label><br>
        <input type="text" name="address" id="address"><br>

        <label for="hours">Hours</label><br>
        <input type="text" name="hours" id="hours"><br>

        <label for="image">Image</label>
		<input type="file" name="my-file" id="image"><br>

        <label for="zipcode">Zipcode</label><br>
        <input type="number" name="zipcode" id="zipcode"><br>


        <label for="state">State</label><br>
        <input type="text" name="state" id="state"><br>

        <label for="city">City</label><br>
        <input type="text" name="city" id="city"><br>

        <span>Business:</span>
        <input type="radio" name="business_type" id="taco_truck" value="taco truck">
        <label for="taco_truck">Taco truck</label>
        <input type="radio" name="business_type" id="taco_stand" value="taco stand">
        <label for="taco_stand">Taco stand</label><br>

        <input type="hidden" id="coordinates" name="coordinates">
        
    
        <button type="submit">Edit</button>
        
    </div>
</form>

<p>or</p>

<div>
    <p>Delete account</p>
    <a href="/deleteVendorAccount"><button>Delete</button></a>
</div>

<script>
    window.addEventListener('load', function() {
        const form = document.getElementById('vendor-form');
        form.addEventListener('submit', function(event) {
            event.preventDefault(); // prevent form submission

            const apiKey = 'AIzaSyD_6bTYpouO3j8eJSzy_Fx61zyZ9SknsXo';
            const address = document.getElementById('address').value;

            fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(address)}&key=${apiKey}`)
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'OK') {
                        const location = data.results[0].geometry.location;
                        const coordinates = [location.lat, location.lng];
                        document.getElementById('coordinates').value = coordinates.join(',');
                        form.submit(); // submit the form after getting the coordinates
                    } else {
                        console.log(`Error: ${data.status}`);
                    }
                })
                .catch(error => console.log('Error:', error));
        });
    });
</script>

{% endblock %}
